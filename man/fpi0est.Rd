% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fpi0est.R
\name{fpi0est}
\alias{fpi0est}
\title{Estimate Functional Proportion of Null Tests}
\usage{
fpi0est(
  p,
  pi0_model_obj = NULL,
  z = NULL,
  pi0_model = NULL,
  indep_snps = NULL,
  lambda = seq(0.05, 0.95, 0.05),
  constrained.p = TRUE,
  tol = 1e-09,
  maxit = 200,
  verbose = TRUE,
  ...
)
}
\arguments{
\item{p}{Numeric vector of p-values.}

\item{pi0_model_obj}{A list object returned by \code{\link{pi0_model}}. This list must
contain two elements: \code{fmod} (the formula) and \code{zt} (the rank-transformed
covariate matrix). If provided, \code{z} and \code{pi0_model} are extracted from this
object automatically, unless overridden by manual arguments.}

\item{z}{Data frame of covariates (output from \code{\link{pi0_model}$zt}).}

\item{pi0_model}{Formula for the pi0 model (output from \code{\link{pi0_model}$fmod}).}

\item{indep_snps}{Optional logical vector indicating independent SNPs for
model fitting. If NULL (default), all SNPs are used.}

\item{lambda}{Numeric vector of lambda thresholds for estimating pi0.
Default is \code{seq(0.05, 0.95, 0.05)}.}

\item{constrained.p}{Logical; use constrained binomial family ensuring
predictions stay within (0, 1). Default is TRUE. Recommended for stability.}

\item{tol}{Numeric; convergence tolerance for \code{\link[fastglm]{fastglm}}.
Default is 1e-9.}

\item{maxit}{Integer; maximum iterations for \code{\link[fastglm]{fastglm}}.
Default is 200.}

\item{verbose}{Logical; print progress messages. Default is TRUE.}

\item{...}{Additional arguments passed to \code{\link[fastglm]{fastglm}}.}
}
\value{
A list containing:
\describe{
  \item{fpi0}{Numeric vector of functional pi0 estimates for each test.}
  \item{tableLambda}{A data frame summarizing results for each lambda value.}
  \item{MISE}{The Mean Integrated Squared Error (MISE) for the chosen model.}
  \item{lambda}{The selected optimal lambda value.}
}
}
\description{
Estimates the functional proportion of null tests (pi0) using a GLM approach
with a constrained binomial family. This function fits models across multiple
lambda thresholds and selects the optimal estimate via MISE minimization.
}
\details{
**Algorithm:**
1. For each lambda threshold, fit a binomial GLM: P(p >= lambda | z)
2. Use constrained binomial family to ensure predictions in (0, 1)
3. Select optimal lambda via MISE

**Model Fitting:**
Uses \code{\link[fastglm]{fastglm}} for efficient GLM fitting with a
constrained binomial family that bounds predictions away from 0 and 1.
}
\examples{
# Import data
data(bmi)

# Separate main p-values and conditioning p-values
p <- sumstats$bmi
z <- as.matrix(sumstats[, -1])

# Apply pi0_model to create model (uses adaptive knot selection)
fmod <- pi0_model(z)

# Estimate functional pi0
fpi0_out <- fpi0est(p, fmod)
fpi0 <- fpi0_out$fpi0
# Apply sffdr
sffdr_out <- sffdr(p, fpi0)

}
